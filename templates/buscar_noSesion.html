<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<!--CSS-->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	    <link rel="stylesheet" type="text/css" media="screen" href="../static/css/style.css" />
	   	<!--CSS-->
	   	<link rel="shortcut icon" href="../static/imagenes/icono.png">
	   	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	   	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<title>Home - MyMusic</title>
	</head>
		<body>	
			<nav class="navbar navbar-custom navbar-fixed-top">
				<div class="container-fluid">
					<div class="navbar-header">
				      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>                        
				      </button>
				      <a class="navbar-brand" href="/" ><span class="glyphicon glyphicon-headphones"></span> MyMusic</a>
				    </div>
				    <div class="collapse navbar-collapse" id="myNavbar" >
				      <ul class="nav navbar-nav">
				        <li class="active"><a href="/">Home</a></li>
				      </ul>
				     <div class="col-sm-3 col-md-3">
				        <form class="navbar-form" role="search" action='/buscar' method="POST">
				        <div class="input-group">
				            <input type="text" class="form-control" placeholder="Buscar" name="Busqueda">
				            <input id = "sesion" type="text" class="form-control" name="Tipo" value = "0" style="display:none;">
				            <div class="input-group-btn">
				                <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
				            </div>
				        </div>
				        </form>
				      </div>
				      <ul class="nav navbar-nav navbar-right">
				      	<li data-toggle="modal" data-target="#Modal-Registro"><a href="#"><span class="glyphicon glyphicon-user"></span> Registrarte</a></li>
			        	<li data-toggle="modal" data-target="#Modal-Login"><a href="#"><span class="glyphicon glyphicon-log-in"></span> Iniciar Sesión</a></li>
				      </ul>
				      
				    </div>
				</div>
			</nav>
		<!--                   Modal Registrarse                         -->
			<div id="Modal-Registro" class="modal fade" role="dialog">
  				<div class="modal-dialog">
    				<div class="modal-content">
      					<div class="modal-header">
        					<button type="button" class="close" data-dismiss="modal" title="Cerrar">&times;</button>
        					<h4 class="text-center" id="titulo">Registro</h4>
      					</div>
      					<div class="modal-body">
        					<form action='/registro' method="POST">
	        					<center>
	        						<label class="text-center" id="tipotext"><h4><b> Nombre:</b></h4></label>
	        					</center>
			        			<center>
			          				<input  type="text" class="form-control" placeholder="Nombre" name="Nombre" required></imput>
								</center>
	        					<br>
	        					<center>
	        						<label class="text-center" id="tipotext"><h4><b> Email:</b></h4></label>
	        					</center>
			        			<center>
			          				<input  type="email" class="form-control" placeholder="correo@example.com" name="Correo" required></imput>
								</center>
	        					<br>
	        					<center>
	        						<label class="text-center" id="tipotext"><h4><b> Contraseña:</b></h4></label>
	        					</center>
			        			<center>
			          				<input  type="password" class="form-control" placeholder="Contraseña" name="Contrasena1" required></imput>
								</center>
	        					<br>
	        					<center>
	        						<label class="text-center" id="tipotext"><h4><b> Confirme su contraseña:</b></h4></label>
	        					</center>
			        			<center>
			          				<input  type="password" class="form-control" placeholder="Contraseña" name="Contrasena2" required></imput>
								</center>	
	        					<br>
								<center>
	        						<label class="text-center" id="tipotext"><h4><b> Palabra secreta:</b></h4></label>
	        					</center>
			        			<center>
			          				<input  type="password" class="form-control" placeholder="Solo letras minúsculas" name="PalabraS" required></imput>
								</center>	
	        					<br>
	        					<center>
	        						<button type="submit" id="b-modal" class="btn btn-lg" >Registrarse</button>
	        					</center>
	        				</form>	
      					</div>
    				</div>
				</div>
			</div>
		<!--                   Fin Modal Registrarse                         -->


		<!--                   Modal Iniciar Sesión                        -->
			<div id="Modal-Login" class="modal fade" role="dialog">
  				<div class="modal-dialog">
    				<div class="modal-content">
      					<div class="modal-header">
        					<button type="button" class="close" data-dismiss="modal" title="Cerrar">&times;</button>
        					<h4 class="text-center" id="titulo">Iniciar Sesión</h4>
      					</div>
      					<div class="modal-body">
        					<form action='/login' method="POST">
	        					<br>
	        					<center>
	        						<label class="text-center" id="tipotext"><h4><b> Correo:</b></h4></label>
	        					</center>
			        			<center>
			          				<input  type="email" class="form-control" placeholder="correo@example.com" name="Usuario" required></imput>
								</center>
	        					<br>
	        					<center>
	        						<label class="text-center" id="tipotext"><h4><b> Contraseña:</b></h4></label>
	        					</center>
			        			<center>
			          				<input  type="password" class="form-control" placeholder="Contraseña" name="pass" required></imput>
								</center>
	        					<br>
	        					<br>
	        					<center>
			          				<a data-dismiss="modal" data-toggle="modal" data-target="#Modal-Recuperar" href="#"> ¿Olvidaste tu contraseña?</a>
								</center>
								<br>
	        					<br>
	        					<center>	        		
	        						<button type="submit" id="b-modal" class="btn btn-lg" >Iniciar Sesión</button>
	        					</center>
							</form>
      					</div>
    				</div>
  				</div>
			</div>
		<!--                    Fin Modal Iniciar Sesión                         -->
		
		<!--                   Modal Recuperar                       -->
			<div id="Modal-Recuperar" class="modal fade" role="dialog">
  				<div class="modal-dialog">
    				<div class="modal-content">
      					<div class="modal-header">
        					<button type="button" class="close" data-dismiss="modal" title="Cerrar">&times;</button>
        					<h4 class="text-center" id="titulo">Recuperar Contraseña</h4>
      					</div>
      					<div class="modal-body">
        					<form action='/recuperar' method="POST">
        						<br>
	        					<center>
	        						<label class="text-center" id="tipotext"><h4><b> Correo:</b></h4></label>
	        					</center>
			        			<center>
			          				<input  type="email" class="form-control" placeholder="correo@example.com" name="Usuario" required></imput>
								</center>
	        					<br>
	        					<center>
	        						<label class="text-center" id="tipotext"><h4><b> Palabra Secreta:</b></h4></label>
	        					</center>
	        					<center>
	        						<input class="form-control" type="password" placeholder="Palabra Secreta" name="palabra" required>
								</center>
	        					<br>
	        					<center>
	        						<button type="submit" id="b-modal" class="btn btn-lg" >Enviar</button>	        		
	        					</center>
							</form>
      					</div>
    				</div>
  				</div>
			</div>
		<!--                    Fin Modal Recuperar                         -->

 			<div class="container-fluid" id = "Titulo">
 				<center>
					<span>Resultados de la Búsqueda</span>
					<i class="fa fa-search fa-lg"></i>
				</center>
			</div>
			<div class="container-fluid" id = "CPlay">
				{%set cont = 0 %}
					{%for i in json1%}
						{%if cont < cantidad%}
							{%if cont % 3 == 0 %}
								{%if cont == 0 %}
									<div class="container-fluid bg-3 text-center"> 
										<div class="row" id = "Fila">	
								{% else %}
										</div>
									</div>
									<div class="container-fluid bg-3 text-center">
										<div class="row" id = "Fila">	
								{% endif %}
							{% endif %}
							<div class="col-sm-4 disco">
								<div id = "Playlist">
									<span>{{i["titulo"]}}</span>
								</div>
								<a id ="Infor" class="btn btn-default btn-sm btn-circle" data-toggle="collapse" data-target={{"#demo" + i["_id"]|string}}><i class="fa fa-info"></i>
					    		</a>
					    		<center>
						    		<div id={{"demo" + i["_id"]|string}} class="collapse demos">
										<div id = "Categoria"> 
					      					<p style="text-align:center; margin-left:1%; margin-right:1%; margin-top:1%;"> {{i["descripcion"]}}</p>
				      					</div>
							  		</div>
						 		</center>
						 		<center>
									<div class="imageContainer">
								    	<a href="/reproductor_no_sesion/{{i['_id']}}"><img  class="imgPlay" src={{'static/imagenes/Usuarios/'+ i["usuario"]|string + '/Playlist/' + i["imagen"] }} alt="Image" width="100%" height="100%"></a>
								    	<a href="/reproductor/{{i['_id']}}"><div class="play"><img src="../static/imagenes/Play.png" alt="Image" width="100%" height="100%"></div></a>
									</div>
								</center>
								<div class="menu-rep">
									<div>
										<i class="h-icon fa fa-heart fa-lg" aria-hidden="true">&nbsp; {{i["me_gusta"]}}</i> 
										<i class="list-icon fa fa-list-ul fa-lg" aria-hidden="true">&nbsp; {{i["canciones"]|length}}</i> 
									</div>
									<div class="div-cat">
										{%for j in i["categorias"]%}
											<span class="cat" > {{j}} </span>
										{% endfor %}
									</div>
								</div>
							</div>
							{%if cont + 1 == Total %}
									</div>
								</div>
							{% else %}
								{%if cont + 1 == 6 %}
									</div>
								</div>
								{% endif %}
							{% endif %}
						{% endif %}
						{%set cont = cont + 1 %}
					{% endfor %}
			</div>
			<script>
					var countC = 0;
					var count = 0;
					var NumP = 6;
					var MiJSON = jQuery.parseJSON('{{json2|safe}}');
					var Total = '{{Total}}'

					$(document).ready(function(){
        				$(document).scroll(function(){
           					if($(document).scrollTop()+$(window).height()>=$(document).height())
            				{
              					if(Total > NumP){
              						var contenedorP, x, fila, x2, columna, x3, i, Titulo, parrafo, titulo, x4, Boton, icono, Centro1, Info, Categ, parrafo2, descripcion, Centro2, Content, Im, imagen, Im2, imagen2, play, menu, div1, like, list, div2, j;

              						contenedorP = document.createElement('div'); 
                					contenedorP.setAttribute("class", ("container-fluid bg-3 text-center"));
                					contenedorP.setAttribute("id", ("Cargar" + countC));
                					x = document.getElementById("CPlay");
                					x.appendChild(contenedorP);

                					fila = document.createElement('div');
                					fila.setAttribute("class", ("row"));
                					fila.setAttribute("id", ("Fila" + countC));
                					x2 = document.getElementById("Cargar" + countC);
                					x2.appendChild(fila);

                					for(i=0; i<3; i++){
                						if(NumP < Total){
                      						columna = document.createElement('div');
                      						columna.setAttribute("class", ("col-sm-4 disco"));
                      						columna.setAttribute("id", ("Columna" + count));
                      						x3 = document.getElementById("Fila" + countC);
                      						x3.appendChild(columna);

                      						Titulo = document.createElement('div');
                      						Titulo.setAttribute("id", ("Playlist"));
                      						parrafo = document.createElement("span");
                     						titulo = document.createTextNode(MiJSON[NumP].titulo);
                      						parrafo.appendChild(titulo);
                      						Titulo.appendChild(parrafo);
                      						x4 = document.getElementById("Columna" + count);
                     	 					x4.appendChild(Titulo);

                      						Boton = document.createElement("a");
                      						Boton.setAttribute("class", ("btn btn-default btn-sm btn-circle"));
                      						Boton.setAttribute("id", ("Infor"));
                      						Boton.setAttribute("data-toggle", ("collapse"));
                      						Boton.setAttribute("data-target", ("#demo" + MiJSON[NumP]._id));
                      						icono = document.createElement("i");
                      						icono.setAttribute("class", ("fa fa-info"));
                     						Boton.appendChild(icono);
                      						x4.appendChild(Boton);

                      						Centro1 = document.createElement("center");
                      						Info = document.createElement('div');
                      						Info.setAttribute("class", ("collapse demos"));
                      						Info.setAttribute("id", ("demo" + MiJSON[NumP]._id));
                      						Categ = document.createElement('div');
                      						Categ.setAttribute("id", ("Categoria"));
                      						parrafo2 = document.createElement("P");
                      						parrafo2.setAttribute("style", ("text-align:center; margin-left:1%; margin-right:1%; margin-top:1%;"));
                      						descripcion = document.createTextNode(MiJSON[NumP].descripcion);
                      						parrafo2.appendChild(descripcion);
                      						Categ.appendChild(parrafo2);
                     				 		Info.appendChild(Categ);
                      						Centro1.appendChild(Info);
                      						x4.appendChild(Centro1);

                      						Centro2 = document.createElement("center");
                      						Content = document.createElement('div');
                      						Content.setAttribute("class", ("imageContainer"));
                      						Im = document.createElement("a");
                      						Im.setAttribute("href", ("/reproductor/" + MiJSON[NumP]._id));
                      						imagen = document.createElement('img');
                      						imagen.setAttribute("class","imgPlay");
                      						imagen.setAttribute("alt","Image");
                      						imagen.src= 'static/imagenes/Usuarios/'+ MiJSON[NumP].usuario + '/Playlist/' + MiJSON[NumP].imagen;
                      						imagen.setAttribute("width","100%");
                      						imagen.setAttribute("height","100%");
                      						Im.appendChild(imagen);

                      						Im2 = document.createElement("a");
                      						Im2.setAttribute("href", ("/reproductor/" + MiJSON[NumP]._id));
                      						play = document.createElement('div');
                      						play.setAttribute("class","play");
                      						imagen2 = document.createElement('img');
                      						imagen2.setAttribute("alt","Image");
                      						imagen2.src= '../static/imagenes/Play.png';
                      						imagen2.setAttribute("width","100%");
                      						imagen2.setAttribute("height","100%");
                      						play.appendChild(imagen2)
                      						Im2.appendChild(play);

                      						Content.appendChild(Im);
                      						Content.appendChild(Im2);
                      						Centro2.appendChild(Content);
                     	 					x4.appendChild(Centro2);

                      						menu=document.createElement('div');
                      						menu.setAttribute("class",("menu-rep"));

                      						div1=document.createElement('div');
                   
                      						like=document.createElement('i');
                      						like.setAttribute("class",("p-icon fa fa-heart fa-lg"));
                      						like.innerHTML= '  ' + MiJSON[NumP].me_gusta;

                      						list=document.createElement('i');
                      						list.setAttribute("class",("p-icon fa fa-list-ul fa-lg"));
                      						list.innerHTML='  ' + MiJSON[NumP].canciones.length;

                      						div1.appendChild(like);
                      						div1.appendChild(list);
                     	 					menu.appendChild(div1);

                      						div2=document.createElement('div');
                      						div2.setAttribute("class",("div-cat"));

                      						for(j=0; j < MiJSON[NumP].categorias.length; j++){
                     	 						var cat1=document.createElement('a');
                      							cat1.setAttribute("class",("cat"));
                      							cat1.innerHTML=MiJSON[NumP].categorias[j];
                      							div2.appendChild(cat1);
                      						}

                      						menu.appendChild(div2);
                      						
                      						columna.appendChild(menu);
                      						count++;
                      						NumP++;
                      					}else{
                      						break;
                      					}
                					}
                					countC++;
            					}
        					}
        				});
    				});
				</script>
		</body>

	<footer id="foot" class="container-fluid text-center">
		<strong>Síguenos en</strong><br>
      	<i class="fa fa-facebook-square fa-2x"></i>
      	<i class="fa fa-twitter-square fa-2x"></i>
      	<i class="fa fa-instagram fa-2x"></i><br>
	</footer>

</html>